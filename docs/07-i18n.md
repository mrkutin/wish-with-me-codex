# Internationalization (i18n)

> Part of [Wish With Me Specification](../AGENTS.md)

---

## 1. Supported Languages

| Code | Language | Status | Direction |
|------|----------|--------|-----------|
| `ru` | Russian | Primary | LTR |
| `en` | English | Secondary | LTR |

---

## 2. Detection Order

1. User preference (stored in `users.locale`)
2. Browser `Accept-Language` header
3. Default: Russian (`ru`)

```typescript
// /services/frontend/src/boot/i18n.ts

import { boot } from 'quasar/wrappers';
import { createI18n } from 'vue-i18n';
import messages from 'src/i18n';

const browserLocale = navigator.language.split('-')[0];
const supportedLocales = ['ru', 'en'];
const defaultLocale = supportedLocales.includes(browserLocale) ? browserLocale : 'ru';

export default boot(({ app }) => {
  const i18n = createI18n({
    locale: defaultLocale,
    fallbackLocale: 'en',
    messages,
    legacy: false
  });

  app.use(i18n);
});
```

---

## 3. Russian Pluralization

Russian has three plural forms:

| Form | Rule | Example (товар/товара/товаров) |
|------|------|--------------------------------|
| one | n % 10 == 1 && n % 100 != 11 | 1, 21, 31, 101... |
| few | n % 10 in 2..4 && n % 100 not in 12..14 | 2, 3, 4, 22, 23... |
| many | everything else | 0, 5-20, 25-30, 100... |

```typescript
// vue-i18n handles this automatically with @intlify/message-compiler
{
  "items": {
    "count": "{count} товар | {count} товара | {count} товаров"
  }
}

// Usage in component
{{ $t('items.count', { count: itemCount }, itemCount) }}
```

---

## 4. Translation Structure

### 4.1 Index File

```typescript
// /services/frontend/src/i18n/index.ts

import ru from './ru';
import en from './en';

export default {
  ru,
  en
};
```

### 4.2 Russian Translations

```typescript
// /services/frontend/src/i18n/ru/index.ts

export default {
  common: {
    loading: 'Загрузка...',
    save: 'Сохранить',
    cancel: 'Отмена',
    delete: 'Удалить',
    edit: 'Редактировать',
    share: 'Поделиться',
    retry: 'Повторить',
    search: 'Поиск',
    offline: 'Нет подключения',
    syncing: 'Синхронизация...',
    syncComplete: 'Все изменения сохранены',
    syncError: 'Ошибка синхронизации'
  },

  auth: {
    login: 'Войти',
    register: 'Регистрация',
    logout: 'Выйти',
    email: 'Электронная почта',
    password: 'Пароль',
    name: 'Имя',
    forgotPassword: 'Забыли пароль?',
    resetPassword: 'Сбросить пароль',
    newPassword: 'Новый пароль',
    confirmPassword: 'Подтвердите пароль',
    continueWithGoogle: 'Продолжить с Google',
    continueWithApple: 'Продолжить с Apple',
    continueWithYandex: 'Продолжить с Яндекс ID',
    continueWithSber: 'Продолжить со Сбер ID',
    orContinueWith: 'или продолжите с',
    noAccount: 'Нет аккаунта?',
    hasAccount: 'Уже есть аккаунт?'
  },

  wishlists: {
    title: 'Мои списки желаний',
    createNew: 'Создать список',
    empty: 'У вас пока нет списков желаний',
    emptyHint: 'Создайте первый список, чтобы начать добавлять товары',
    itemCount: '{count} товар | {count} товара | {count} товаров',
    deleteConfirm: 'Удалить список "{title}"?',
    deleteWarning: 'Все товары в списке будут удалены'
  },

  items: {
    addItem: 'Добавить товар',
    pasteUrl: 'Вставьте ссылку на товар',
    addManually: 'Добавить вручную',
    resolving: 'Загружаем информацию о товаре...',
    resolveFailed: 'Не удалось загрузить данные',
    quantity: 'Количество',
    price: 'Цена',
    description: 'Описание',
    empty: 'Этот список пока пуст',
    emptyHint: 'Добавьте товары, вставив ссылку или вручную'
  },

  marks: {
    mark: 'Отметить',
    unmark: 'Снять отметку',
    marked: 'Отмечено',
    markedByYou: 'Отмечено вами',
    allMarked: 'Всё отмечено',
    available: 'Доступно',
    howMany: 'Сколько вы возьмёте?',
    yourItem: 'Ваш товар'
  },

  share: {
    shareWishlist: 'Поделиться списком',
    copyLink: 'Копировать ссылку',
    linkCopied: 'Ссылка скопирована',
    qrCode: 'QR-код',
    expiresIn: 'Истекает через {days} дн.',
    noExpiry: 'Бессрочно',
    revokeLink: 'Отозвать ссылку'
  },

  profile: {
    editProfile: 'Редактировать профиль',
    avatar: 'Аватар',
    bio: 'О себе',
    socialLinks: 'Социальные сети',
    publicUrl: 'Публичная ссылка'
  },

  settings: {
    title: 'Настройки',
    account: 'Аккаунт',
    connectedAccounts: 'Подключённые аккаунты',
    language: 'Язык',
    notifications: 'Уведомления',
    deleteAccount: 'Удалить аккаунт'
  },

  notifications: {
    title: 'Уведомления',
    empty: 'Пока нет уведомлений',
    emptyHint: 'Здесь вы увидите обновления по вашим спискам',
    markAllRead: 'Отметить все как прочитанные',
    itemResolved: 'Товар "{title}" загружен',
    itemFailed: 'Не удалось загрузить "{title}"',
    wishlistShared: '{name} просматривает ваш список'
  },

  errors: {
    network: 'Ошибка сети. Проверьте подключение.',
    unauthorized: 'Сессия истекла, войдите снова',
    notFound: 'Страница не найдена',
    serverError: 'Ошибка сервера. Попробуйте позже.',
    validationError: 'Проверьте введённые данные'
  }
};
```

### 4.3 English Translations

```typescript
// /services/frontend/src/i18n/en/index.ts

export default {
  common: {
    loading: 'Loading...',
    save: 'Save',
    cancel: 'Cancel',
    delete: 'Delete',
    edit: 'Edit',
    share: 'Share',
    retry: 'Retry',
    search: 'Search',
    offline: 'You\'re offline',
    syncing: 'Syncing...',
    syncComplete: 'All changes saved',
    syncError: 'Sync failed'
  },

  auth: {
    login: 'Log in',
    register: 'Sign up',
    logout: 'Log out',
    email: 'Email',
    password: 'Password',
    name: 'Name',
    forgotPassword: 'Forgot password?',
    resetPassword: 'Reset password',
    newPassword: 'New password',
    confirmPassword: 'Confirm password',
    continueWithGoogle: 'Continue with Google',
    continueWithApple: 'Continue with Apple',
    continueWithYandex: 'Continue with Yandex ID',
    continueWithSber: 'Continue with Sber ID',
    orContinueWith: 'or continue with',
    noAccount: 'Don\'t have an account?',
    hasAccount: 'Already have an account?'
  },

  wishlists: {
    title: 'My Wishlists',
    createNew: 'Create wishlist',
    empty: 'You don\'t have any wishlists yet',
    emptyHint: 'Create your first wishlist to start adding items',
    itemCount: '{count} item | {count} items',
    deleteConfirm: 'Delete "{title}"?',
    deleteWarning: 'All items in this wishlist will be deleted'
  },

  items: {
    addItem: 'Add item',
    pasteUrl: 'Paste item URL',
    addManually: 'Add manually',
    resolving: 'Loading item details...',
    resolveFailed: 'Failed to load item',
    quantity: 'Quantity',
    price: 'Price',
    description: 'Description',
    empty: 'This wishlist is empty',
    emptyHint: 'Add items by pasting a link or manually'
  },

  marks: {
    mark: 'Mark',
    unmark: 'Unmark',
    marked: 'Marked',
    markedByYou: 'Marked by you',
    allMarked: 'All marked',
    available: 'Available',
    howMany: 'How many will you get?',
    yourItem: 'Your item'
  },

  share: {
    shareWishlist: 'Share wishlist',
    copyLink: 'Copy link',
    linkCopied: 'Link copied',
    qrCode: 'QR code',
    expiresIn: 'Expires in {days} days',
    noExpiry: 'No expiry',
    revokeLink: 'Revoke link'
  },

  profile: {
    editProfile: 'Edit profile',
    avatar: 'Avatar',
    bio: 'Bio',
    socialLinks: 'Social links',
    publicUrl: 'Public URL'
  },

  settings: {
    title: 'Settings',
    account: 'Account',
    connectedAccounts: 'Connected accounts',
    language: 'Language',
    notifications: 'Notifications',
    deleteAccount: 'Delete account'
  },

  notifications: {
    title: 'Notifications',
    empty: 'No notifications yet',
    emptyHint: 'You\'ll see updates about your wishlists here',
    markAllRead: 'Mark all as read',
    itemResolved: 'Item "{title}" loaded',
    itemFailed: 'Failed to load "{title}"',
    wishlistShared: '{name} is viewing your wishlist'
  },

  errors: {
    network: 'Network error. Check your connection.',
    unauthorized: 'Session expired, please log in again',
    notFound: 'Page not found',
    serverError: 'Server error. Try again later.',
    validationError: 'Please check your input'
  }
};
```

---

## 5. Date/Time Formatting

```typescript
// /services/frontend/src/utils/formatters.ts

export function formatDate(date: string | Date, locale: string): string {
  return new Intl.DateTimeFormat(locale, {
    day: 'numeric',
    month: 'long',
    year: 'numeric'
  }).format(new Date(date));
}

export function formatRelativeTime(date: string | Date, locale: string): string {
  const rtf = new Intl.RelativeTimeFormat(locale, { numeric: 'auto' });
  const diff = Date.now() - new Date(date).getTime();
  const days = Math.floor(diff / (1000 * 60 * 60 * 24));

  if (days === 0) return rtf.format(0, 'day'); // "сегодня" / "today"
  if (days === 1) return rtf.format(-1, 'day'); // "вчера" / "yesterday"
  if (days < 7) return rtf.format(-days, 'day');
  if (days < 30) return rtf.format(-Math.floor(days / 7), 'week');
  return rtf.format(-Math.floor(days / 30), 'month');
}
```

---

## 6. Currency Formatting

```typescript
export function formatPrice(
  amount: number,
  currency: string,
  locale: string
): string {
  return new Intl.NumberFormat(locale, {
    style: 'currency',
    currency: currency,
    minimumFractionDigits: 0,
    maximumFractionDigits: 2
  }).format(amount);
}

// Examples:
// formatPrice(5990, 'RUB', 'ru') → "5 990 ₽"
// formatPrice(5990, 'RUB', 'en') → "RUB 5,990"
// formatPrice(99.99, 'USD', 'en') → "$99.99"
```

---

## 7. RTL Future-Proofing

Use logical CSS properties for future RTL support:

```scss
// Instead of:
margin-left: 8px;    → margin-inline-start: 8px;
margin-right: 8px;   → margin-inline-end: 8px;
padding-left: 16px;  → padding-inline-start: 16px;
text-align: left;    → text-align: start;
text-align: right;   → text-align: end;
float: left;         → float: inline-start;
border-left: 1px;    → border-inline-start: 1px;
```
