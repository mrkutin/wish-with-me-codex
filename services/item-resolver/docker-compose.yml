services:
  item-resolver:
    build:
      context: .
      dockerfile: Dockerfile
    environment:
      - RU_BEARER_TOKEN=${RU_BEARER_TOKEN}
      - RU_FETCHER_MODE=playwright
      - BROWSER_CHANNEL=${BROWSER_CHANNEL:-chromium}
      - HEADLESS=${HEADLESS:-true}
      - MAX_CONCURRENCY=${MAX_CONCURRENCY:-2}
      - STORAGE_STATE_DIR=/data/storage_state
      # Optional: comma-separated allowlist to bypass DNS/IP SSRF checks for known-safe hosts.
      - SSRF_ALLOWLIST_HOSTS=${SSRF_ALLOWLIST_HOSTS:-}
      # Optional: proxy settings for Playwright.
      - PROXY_SERVER=${PROXY_SERVER:-}
      - PROXY_USERNAME=${PROXY_USERNAME:-}
      - PROXY_PASSWORD=${PROXY_PASSWORD:-}
      - PROXY_BYPASS=${PROXY_BYPASS:-}
      - PROXY_IGNORE_CERT_ERRORS=${PROXY_IGNORE_CERT_ERRORS:-}
    volumes:
      - ./storage_state:/data/storage_state
    ports:
      - "8000:8000"

volumes: {}
